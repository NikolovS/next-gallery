(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[590],{6437:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/product/[id]",function(){return c(376)}])},376:function(h,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return K}});var i=a(7568),j=a(6042),k=a(9396),c=a(4051),l=a.n(c),m=a(5893),n=a(7294),d=a(9669),o=a.n(d),e=a(5152),f=a.n(e),p=a(1163),g=a(1664),q=a.n(g),r=a(1749),s=a(8463),t=a(2822),u=a(998),v=a(5757),w=a(2318),x=a(5477),y=a(8101),z=a(282),A=a(553),B=a(797),C=a(1419),D=a(8766),E=a(5789),F=a(9629),G=a(7536),H=a(6935);function I(a,b){switch(b.type){case"FETCH_REQUEST":return(0,k.Z)((0,j.Z)({},a),{loading:!0,error:""});case"FETCH_SUCCESS":return(0,k.Z)((0,j.Z)({},a),{loading:!1,error:""});case"FETCH_FAIL":return(0,k.Z)((0,j.Z)({},a),{loading:!1,error:b.payload});case"UPDATE_REQUEST":return(0,k.Z)((0,j.Z)({},a),{loadingUpdate:!0,errorUpdate:""});case"UPDATE_SUCCESS":return(0,k.Z)((0,j.Z)({},a),{loadingUpdate:!1,errorUpdate:""});case"UPDATE_FAIL":return(0,k.Z)((0,j.Z)({},a),{loadingUpdate:!1,errorUpdate:b.payload});case"UPLOAD_REQUEST":return(0,k.Z)((0,j.Z)({},a),{loadingUpload:!0,errorUpload:""});case"UPLOAD_SUCCESS":return(0,k.Z)((0,j.Z)({},a),{loadingUpload:!1,errorUpload:""});case"UPLOAD_FAIL":return(0,k.Z)((0,j.Z)({},a),{loadingUpload:!1,errorUpload:b.payload});default:return a}}function J(K){var L,e=K.params.id,f=(0,n.useState)(!1),M=f[0],U=f[1],N=(0,n.useContext)(D.y).state,g=(0,n.useReducer)(I,{loading:!0,error:""}),b=g[0],O=b.loading,h=b.error,P=b.loadingUpdate,k=b.loadingUpload,V=g[1],c=(0,G.cI)(),Q=c.handleSubmit,a=c.control,W=c.formState.errors,X=c.setValue,J=(0,H.Ds)(),Y=J.enqueueSnackbar,Z=J.closeSnackbar,$=(0,p.useRouter)(),d=(0,F.Z)(),_=N.userInfo;(0,n.useEffect)(function(){var a;if(!_)return $.push("/login");(a=(0,i.Z)(l().mark(function a(){var b;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,V({type:"FETCH_REQUEST"}),a.next=4,o().get("/api/admin/products/".concat(e),{headers:{authorization:"Bearer ".concat(_.token)}});case 4:b=a.sent.data,V({type:"FETCH_SUCCESS"}),X("name",b.name),X("slug",b.slug),X("price",b.price),X("image",b.image),X("category",b.category),X("brand",b.brand),X("featuredImage",b.featuredImage),U(b.isFeatured),X("countInStock",b.countInStock),X("description",b.description),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(0),V({type:"FETCH_FAIL",payload:(0,C.b)(a.t0)});case 21:case"end":return a.stop()}},a,null,[[0,18]])})),function(){return a.apply(this,arguments)})()},[]);var R,S=(L=(0,i.Z)(l().mark(function a(b){var c,d,e,f,g=arguments;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=g.length>1&& void 0!==g[1]?g[1]:"image",d=b.target.files[0],(e=new FormData).append("file",d),a.prev=4,V({type:"UPLOAD_REQUEST"}),a.next=8,o().post("/api/admin/upload",e,{headers:{"Content-Type":"multipart/form-data",authorization:"Bearer ".concat(_.token)}});case 8:f=a.sent.data,V({type:"UPLOAD_SUCCESS"}),X(c,f.secure_url),console.log("data",f),Y("File uploaded successfully",{variant:"success"}),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(4),V({type:"UPLOAD_FAIL",payload:(0,C.b)(a.t0)}),Y((0,C.b)(a.t0),{variant:"error"});case 19:case"end":return a.stop()}},a,null,[[4,15]])})),function(a){return L.apply(this,arguments)}),T=(R=(0,i.Z)(l().mark(function a(b){var c,d,f,g,h,i,j,k,m;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.name,d=b.slug,f=b.price,g=b.category,h=b.image,i=b.brand,j=b.countInStock,k=b.description,m=b.featuredImage,Z(),a.prev=2,V({type:"UPDATE_REQUEST"}),a.next=6,o().put("/api/admin/products/".concat(e),{name:c,slug:d,price:f,category:g,image:h,isFeatured:M,featuredImage:m,brand:i,countInStock:j,description:k},{headers:{authorization:"Bearer ".concat(_.token)}});case 6:V({type:"UPDATE_SUCCESS"}),Y("Product updated successfully",{variant:"success"}),$.push("/admin/products"),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(2),V({type:"UPDATE_FAIL",payload:(0,C.b)(a.t0)}),Y((0,C.b)(a.t0),{variant:"error"});case 15:case"end":return a.stop()}},a,null,[[2,11]])})),function(a){return R.apply(this,arguments)});return(0,m.jsx)(E.Z,{title:"Edit Product ".concat(e),children:(0,m.jsxs)(r.Z,{container:!0,spacing:1,children:[(0,m.jsx)(r.Z,{item:!0,md:3,xs:12,children:(0,m.jsx)(s.Z,{className:d.section,children:(0,m.jsxs)(t.Z,{children:[(0,m.jsx)(q(),{href:"/admin/dashboard",passHref:!0,children:(0,m.jsx)(u.Z,{button:!0,component:"a",children:(0,m.jsx)(v.Z,{primary:"Admin Dashboard"})})}),(0,m.jsx)(q(),{href:"/admin/orders",passHref:!0,children:(0,m.jsx)(u.Z,{button:!0,component:"a",children:(0,m.jsx)(v.Z,{primary:"Orders"})})}),(0,m.jsx)(q(),{href:"/admin/products",passHref:!0,children:(0,m.jsx)(u.Z,{selected:!0,button:!0,component:"a",children:(0,m.jsx)(v.Z,{primary:"Products"})})}),(0,m.jsx)(q(),{href:"/admin/users",passHref:!0,children:(0,m.jsx)(u.Z,{button:!0,component:"a",children:(0,m.jsx)(v.Z,{primary:"Users"})})})]})})}),(0,m.jsx)(r.Z,{item:!0,md:9,xs:12,children:(0,m.jsx)(s.Z,{className:d.section,children:(0,m.jsxs)(t.Z,{children:[(0,m.jsx)(u.Z,{children:(0,m.jsxs)(w.Z,{component:"h1",variant:"h1",children:["Edit Product ",e]})}),(0,m.jsxs)(u.Z,{children:[O&&(0,m.jsx)(x.Z,{}),h&&(0,m.jsx)(w.Z,{className:d.error,children:h})]}),(0,m.jsx)(u.Z,{children:(0,m.jsx)("form",{onSubmit:Q(T),className:d.form,children:(0,m.jsxs)(t.Z,{children:[(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"name",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"name",label:"Name",error:Boolean(W.name),helperText:W.name?"Name is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"slug",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"slug",label:"Slug",error:Boolean(W.slug),helperText:W.slug?"Slug is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"price",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"price",label:"Price",error:Boolean(W.price),helperText:W.price?"Price is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"image",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"image",label:"Image",error:Boolean(W.image),helperText:W.image?"Image is required":""},b))}})}),(0,m.jsxs)(u.Z,{children:[(0,m.jsxs)(z.Z,{variant:"contained",component:"label",children:["Upload File",(0,m.jsx)("input",{type:"file",onChange:S,hidden:!0})]}),k&&(0,m.jsx)(x.Z,{})]}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(A.Z,{label:"Is Featured",control:(0,m.jsx)(B.Z,{onClick:function(a){return U(a.target.checked)},checked:M,name:"isFeatured"})})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"featuredImage",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"featuredImage",label:"Featured Image",error:Boolean(W.image),helperText:W.image?"Featured Image is required":""},b))}})}),(0,m.jsxs)(u.Z,{children:[(0,m.jsxs)(z.Z,{variant:"contained",component:"label",children:["Upload File",(0,m.jsx)("input",{type:"file",onChange:function(a){return S(a,"featuredImage")},hidden:!0})]}),k&&(0,m.jsx)(x.Z,{})]}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"category",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"category",label:"Category",error:Boolean(W.category),helperText:W.category?"Category is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"brand",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"brand",label:"Brand",error:Boolean(W.brand),helperText:W.brand?"Brand is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"countInStock",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,id:"countInStock",label:"Count in stock",error:Boolean(W.countInStock),helperText:W.countInStock?"Count in stock is required":""},b))}})}),(0,m.jsx)(u.Z,{children:(0,m.jsx)(G.Qr,{name:"description",control:a,defaultValue:"",rules:{required:!0},render:function(a){var b=a.field;return(0,m.jsx)(y.Z,(0,j.Z)({variant:"outlined",fullWidth:!0,multiline:!0,id:"description",label:"Description",error:Boolean(W.description),helperText:W.description?"Description is required":""},b))}})}),(0,m.jsxs)(u.Z,{children:[(0,m.jsx)(z.Z,{variant:"contained",type:"submit",fullWidth:!0,color:"primary",children:"Update"}),P&&(0,m.jsx)(x.Z,{})]})]})})})]})})})]})})}var K=!0;b.default=f()(function(){return Promise.resolve(J)},{ssr:!1})}},function(a){a.O(0,[961,101,125,924,267,536,932,789,774,888,179],function(){var b;return a(a.s=6437)}),_N_E=a.O()}])