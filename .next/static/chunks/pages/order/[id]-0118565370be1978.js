(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[441],{5477:function(f,b,a){"use strict";var g=a(7462),h=a(5987),c=a(7294),i=a(6010),d=a(1591),j=a(3871),e=c.forwardRef(function(b,w){var a=b.classes,x=b.className,k=b.color,l=void 0===k?"primary":k,m=b.disableShrink,n=b.size,o=void 0===n?40:n,y=b.style,p=b.thickness,e=void 0===p?3.6:p,q=b.value,r=void 0===q?0:q,s=b.variant,d=void 0===s?"indeterminate":s,z=(0,h.Z)(b,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),f={},t={},u={};if("determinate"===d||"static"===d){var v=2*Math.PI*((44-e)/2);f.strokeDasharray=v.toFixed(3),u["aria-valuenow"]=Math.round(r),f.strokeDashoffset="".concat(((100-r)/100*v).toFixed(3),"px"),t.transform="rotate(-90deg)"}return c.createElement("div",(0,g.Z)({className:(0,i.Z)(a.root,x,"inherit"!==l&&a["color".concat((0,j.Z)(l))],{determinate:a.determinate,indeterminate:a.indeterminate,static:a.static}[d]),style:(0,g.Z)({width:o,height:o},t,y),ref:w,role:"progressbar"},u,z),c.createElement("svg",{className:a.svg,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},c.createElement("circle",{className:(0,i.Z)(a.circle,void 0!==m&&m&&a.circleDisableShrink,{determinate:a.circleDeterminate,indeterminate:a.circleIndeterminate,static:a.circleStatic}[d]),style:f,cx:44,cy:44,r:(44-e)/2,fill:"none",strokeWidth:e})))});b.Z=(0,d.Z)(function(a){return{root:{display:"inline-block"},static:{transition:a.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:a.transitions.create("transform")},colorPrimary:{color:a.palette.primary.main},colorSecondary:{color:a.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:a.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:a.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}},{name:"MuiCircularProgress",flip:!1})(e)},840:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order/[id]",function(){return c(2396)}])},2913:function(c,b,a){"use strict";a.d(b,{Z:function(){return i}});var d=a(5893),e=a(5357),f=a(1594),g=a(2876);a(7294);var h=a(9629);function i(b){var a=b.activeStep,c=(0,h.Z)();return(0,d.jsx)(e.Z,{className:c.transperantBackground,activeStep:void 0===a?0:a,alternativeLabel:!0,children:["Login","Shipping Address","Payment Method","Place Order"].map(function(a){return(0,d.jsx)(f.Z,{children:(0,d.jsx)(g.Z,{children:a})},a)})})}},2396:function(i,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return S},default:function(){return T}});var j=a(7568),k=a(6042),l=a(9396),m=a(3375),n=a(1566),c=a(4051),o=a.n(c),p=a(5893),q=a(7294),d=a(5152),e=a.n(d),r=a(5789),s=a(8766),f=a(1664),t=a.n(f),g=a(5675),u=a.n(g),v=a(2318),w=a(5477),x=a(1749),y=a(8463),z=a(2822),A=a(998),B=a(6847),C=a(2302),D=a(3750),E=a(7394),F=a(8222),G=a(9613),H=a(9659),I=a(282),h=a(9669),J=a.n(h),K=a(1163),L=a(9629),M=a(2913),N=a(1419),O=a(5021),P=a(6935);function Q(a,b){switch(b.type){case"FETCH_REQUEST":return(0,l.Z)((0,k.Z)({},a),{loading:!0,error:""});case"FETCH_SUCCESS":return(0,l.Z)((0,k.Z)({},a),{loading:!1,order:b.payload,error:""});case"FETCH_FAILED":return(0,l.Z)((0,k.Z)({},a),{loading:!1,error:b.payload});case"PAY_REQUEST":return(0,l.Z)((0,k.Z)({},a),{loadingPay:!0});case"PAY_SUCCESS":return(0,l.Z)((0,k.Z)({},a),{loadingPay:!1,successPay:!0});case"PAY_FAILED":return(0,l.Z)((0,k.Z)({},a),{loadingPay:!1,errorPay:b.payload});case"PAY_RESET":return(0,l.Z)((0,k.Z)({},a),{loadingPay:!1,errorPay:"",successPay:!1});case"DELIVER_REQUEST":return(0,l.Z)((0,k.Z)({},a),{loadingDeliver:!0});case"DELIVER_SUCCESS":return(0,l.Z)((0,k.Z)({},a),{loadingDeliver:!1,successDeliver:!0});case"DELIVER_FAIL":return(0,l.Z)((0,k.Z)({},a),{loadingDeliver:!1,errorDeliver:b.payload});case"DELIVER_RESET":return(0,l.Z)((0,k.Z)({},a),{loadingDeliver:!1,successDeliver:!1,errorDeliver:""})}}function R(R){var e,f,ag,g=R.params.id,h=(e=(0,O.Up)(),f=2,function(a){if(Array.isArray(a))return a}(e)||(0,m.Z)(e,f)||(0,n.Z)(e,f)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),S=h[0].isPending,ah=h[1],b=(0,L.Z)(),ai=(0,K.useRouter)(),T=(0,q.useContext)(s.y).state,U=T.userInfo,aj=(0,P.Ds)().enqueueSnackbar,i=(0,q.useReducer)(Q,{loading:!0,order:{},error:""}),c=i[0],V=c.loading,k=c.error,a=c.order,W=c.successPay,X=c.loadingDeliver,Y=c.successDeliver,ak=i[1],d=a.shippingAddress,Z=a.paymentMethod,$=a.orderItems,_=a.itemsPrice,aa=a.taxPrice,ab=a.shippingPrice,ac=a.totalPrice,ad=a.deliveredAt,ae=a.isDelivered,l=a.isPaid,af=a.paidAt;function al(){return(al=(0,j.Z)(o().mark(function b(){var c;return o().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,ak({type:"DELIVER_REQUEST"}),b.next=4,J().put("/api/orders/".concat(a._id,"/deliver"),{},{headers:{authorization:"Bearer ".concat(U.token)}});case 4:ak({type:"DELIVER_SUCCESS",payload:c=b.sent.data}),aj("Order is delivered",{variant:"success"}),b.next=13;break;case 9:b.prev=9,b.t0=b.catch(0),ak({type:"DELIVER_FAIL",payload:(0,N.b)(b.t0)}),aj((0,N.b)(b.t0),{variant:"error"});case 13:case"end":return b.stop()}},b,null,[[0,9]])}))).apply(this,arguments)}return console.log(a),(0,q.useEffect)(function(){if(!U)return ai.push("/login");var b,c,d=(c=(0,j.Z)(o().mark(function a(){var b;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,ak({type:"FETCH_REQUEST"}),a.next=4,J().get("/api/orders/".concat(g),{headers:{authorization:"Bearer ".concat(U.token)}});case 4:ak({type:"FETCH_SUCCESS",payload:b=a.sent.data}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),ak({type:"FETCH_FAIL",paylod:(0,N.b)(a.t0)});case 11:case"end":return a.stop()}},a,null,[[0,8]])})),function(){return c.apply(this,arguments)});!a._id||W||Y||a._id&&a._id!==g?(d(),W&&ak({type:"PAY_RESET"}),Y&&ak({type:"DELIVER_RESET"})):(b=(0,j.Z)(o().mark(function a(){var b,c;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,J().get("/api/keys/paypal",{headers:{authorization:"Bearer ".concat(U.token)}});case 2:ah({type:"resetOptions",value:{"client-id":c=(b=a.sent).data,currency:"USD"}}),ah({type:"setLoadingStatus",value:"pending"});case 6:case"end":return a.stop()}},a)})),function(){return b.apply(this,arguments)})()},[a,W,Y]),(0,p.jsxs)(r.Z,{title:"Order ".concat(g),children:[(0,p.jsx)(M.Z,{activeStep:3}),(0,p.jsxs)(v.Z,{component:"h1",variant:"h1",children:["Order ",g]}),V?(0,p.jsx)(w.Z,{}):k?(0,p.jsx)(v.Z,{className:b.error,children:k}):(0,p.jsxs)(x.Z,{container:!0,spacing:1,children:[(0,p.jsxs)(x.Z,{item:!0,md:9,xs:12,children:[(0,p.jsx)(y.Z,{className:b.section,children:(0,p.jsxs)(z.Z,{children:[(0,p.jsx)(A.Z,{children:(0,p.jsx)(v.Z,{component:"h2",variant:"h2",children:"Shipping Address"})}),(0,p.jsxs)(A.Z,{children:[d.fullName,", ",d.address,","," ",d.city,", ",d.postalCode,","," ",d.country]}),(0,p.jsxs)(A.Z,{children:["Status:"," ",ae?"delivered at ".concat(ad):"not delivered"]})]})}),(0,p.jsx)(y.Z,{className:b.section,children:(0,p.jsxs)(z.Z,{children:[(0,p.jsx)(A.Z,{children:(0,p.jsx)(v.Z,{component:"h2",variant:"h2",children:"Payment Method"})}),(0,p.jsx)(A.Z,{children:Z}),(0,p.jsxs)(A.Z,{children:["Status: ",l?"delivered at ".concat(af):"not paid"]})]})}),(0,p.jsx)(y.Z,{className:b.section,children:(0,p.jsxs)(z.Z,{children:[(0,p.jsx)(A.Z,{children:(0,p.jsx)(v.Z,{component:"h2",variant:"h2",children:"Order Items"})}),(0,p.jsx)(A.Z,{children:(0,p.jsx)(B.Z,{children:(0,p.jsxs)(C.Z,{children:[(0,p.jsx)(D.Z,{children:(0,p.jsxs)(E.Z,{children:[(0,p.jsx)(F.Z,{children:"Image"}),(0,p.jsx)(F.Z,{children:"Name"}),(0,p.jsx)(F.Z,{align:"right",children:"Quantity"}),(0,p.jsx)(F.Z,{align:"right",children:"Price"})]})}),(0,p.jsx)(G.Z,{children:$.map(function(a){return(0,p.jsxs)(E.Z,{children:[(0,p.jsx)(F.Z,{children:(0,p.jsx)(t(),{href:"/product/".concat(a.slug),passHref:!0,children:(0,p.jsx)(H.Z,{children:(0,p.jsx)(u(),{src:a.image,alt:a.name,width:50,height:50})})})}),(0,p.jsx)(F.Z,{children:(0,p.jsx)(t(),{href:"/product/".concat(a.slug),passHref:!0,children:(0,p.jsx)(H.Z,{children:(0,p.jsx)(v.Z,{children:a.name})})})}),(0,p.jsx)(F.Z,{align:"right",children:a.quantity}),(0,p.jsxs)(F.Z,{align:"right",children:["$",a.price]})]},a._id)})})]})})})]})})]}),(0,p.jsx)(x.Z,{md:3,xs:12,children:(0,p.jsx)(y.Z,{className:b.section,children:(0,p.jsxs)(z.Z,{children:[(0,p.jsx)(A.Z,{children:(0,p.jsx)(v.Z,{variant:"h2",children:"Order Summary"})}),(0,p.jsx)(A.Z,{children:(0,p.jsxs)(x.Z,{container:!0,children:[(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsx)(v.Z,{children:"Items:"})}),(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsxs)(v.Z,{align:"right",children:["$",_]})})]})}),(0,p.jsx)(A.Z,{children:(0,p.jsxs)(x.Z,{container:!0,children:[(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsx)(v.Z,{children:"Tax:"})}),(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsxs)(v.Z,{align:"right",children:["$",aa]})})]})}),(0,p.jsx)(A.Z,{children:(0,p.jsxs)(x.Z,{container:!0,children:[(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsx)(v.Z,{children:"Shipping:"})}),(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsxs)(v.Z,{align:"right",children:["$",ab]})})]})}),(0,p.jsx)(A.Z,{children:(0,p.jsxs)(x.Z,{container:!0,children:[(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsx)(v.Z,{children:(0,p.jsx)("strong",{children:"Total:"})})}),(0,p.jsx)(x.Z,{item:!0,xs:6,children:(0,p.jsx)(v.Z,{align:"right",children:(0,p.jsxs)("strong",{children:["$",ac]})})})]})}),!l&&(0,p.jsx)(A.Z,{children:S?(0,p.jsx)(w.Z,{}):(0,p.jsx)("div",{className:b.fullWidth,children:(0,p.jsx)(O.ch,{createOrder:function(b,a){return a.order.create({purchase_units:[{amount:{value:ac}},]}).then(function(a){return a})},onApprove:function(d,b){var c;return b.order.capture().then((c=(0,j.Z)(o().mark(function b(c){var d;return o().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,ak({type:"PAY_REQUEST"}),b.next=4,J().put("/api/orders/".concat(a._id,"/pay"),c,{headers:{authorization:"Bearer ".concat(U.token)}});case 4:ak({type:"PAY_SUCCESS",payload:d=b.sent.data}),aj("Order is paid",{variant:"success"}),b.next=13;break;case 9:b.prev=9,b.t0=b.catch(0),ak({type:"PAY_FAIL",payload:(0,N.b)(b.t0)}),aj((0,N.b)(b.t0),{variant:"error"});case 13:case"end":return b.stop()}},b,null,[[0,9]])})),function(a){return c.apply(this,arguments)}))},onError:function(a){aj((0,N.b)(a),{variant:"error"})}})})}),U.isAdmin&&a.isPaid&&!a.isDelivered&&(0,p.jsxs)(A.Z,{children:[X&&(0,p.jsx)(w.Z,{}),(0,p.jsx)(I.Z,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(){return al.apply(this,arguments)},children:"Deliver Order"})]})]})})})]})]})}var S=!0,T=e()(function(){return Promise.resolve(R)},{ssr:!1})}},function(a){a.O(0,[961,48,170,349,675,324,789,774,888,179],function(){var b;return a(a.s=840)}),_N_E=a.O()}])